<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hi·ªáu Chu·∫©n - Farm365</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 10px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; }
        header { background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; padding: 20px; text-align: center; }
        h1 { font-size: 1.8em; margin-bottom: 10px; }
        .nav { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; padding: 15px; background: #f5f5f5; }
        .nav a { text-decoration: none; padding: 10px 20px; background: #4CAF50; color: white; border-radius: 25px; transition: all 0.3s; font-size: 0.9em; }
        .nav a:hover { background: #45a049; }
        .nav a.active { background: #2e7d32; }
        .content { padding: 15px; }
        .section { margin-bottom: 20px; padding: 15px; background: #f9f9f9; border-radius: 10px; border: 2px solid #e0e0e0; }
        .section h3 { color: #2e7d32; margin-bottom: 15px; font-size: 1.3em; }
        .btn { padding: 14px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1em; transition: all 0.3s; margin: 5px 0; width: 100%; }
        .btn-primary { background: #4CAF50; color: white; }
        .btn-primary:hover { background: #45a049; }
        .btn-secondary { background: #2196F3; color: white; }
        .btn-secondary:hover { background: #0b7dda; }
        .btn-danger { background: #f44336; color: white; }
        .btn-danger:hover { background: #da190b; }
        .btn-warning { background: #ff9800; color: white; }
        .btn-warning:hover { background: #e68900; }
        .info-box { background: #e3f2fd; padding: 12px; border-radius: 5px; margin-top: 15px; border-left: 4px solid #2196F3; font-size: 0.9em; }
        .warning-box { background: #fff3cd; padding: 12px; border-radius: 5px; margin-top: 15px; border-left: 4px solid #ffc107; font-size: 0.9em; }
        .success-box { background: #d4edda; padding: 12px; border-radius: 5px; margin-top: 15px; border-left: 4px solid #28a745; font-size: 0.9em; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #555; font-size: 1em; }
        .form-group input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 5px; font-size: 1.1em; }
        .form-group input:focus { border-color: #4CAF50; outline: none; }
        .form-group small { font-size: 0.85em; color: #999; display: block; margin-top: 5px; }
        .status { font-size: 1em; color: #666; margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        
        /* Desktop styles */
        @media (min-width: 768px) {
            body { padding: 20px; }
            h1 { font-size: 2.5em; }
            header { padding: 30px; }
            .content { padding: 30px; }
            .section { padding: 20px; margin-bottom: 30px; }
            .section h3 { font-size: 1.5em; }
            .btn { width: auto; margin: 5px; padding: 12px 30px; font-size: 1em; }
            .info-box, .warning-box, .success-box { padding: 15px; }
            .form-group input { padding: 10px; font-size: 1em; }
            .status { font-size: 1.2em; }
            .nav a { padding: 12px 30px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üî¨ Hi·ªáu Chu·∫©n C·∫£m Bi·∫øn</h1>
            <p>ƒêi·ªÅu Ch·ªânh pH v√† TDS ƒë·ªÉ ƒêo Ch√≠nh X√°c</p>
        </header>
        <nav class="nav">
            <a href="/">Trang ch·ªß</a>
            <a href="/dashboard">Dashboard</a>
            <a href="/config">C·∫•u H√¨nh</a>
            <a href="/manual">ƒêi·ªÅu Khi·ªÉn</a>
            <a href="/calibration" class="active">Hi·ªáu Chu·∫©n</a>
        </nav>
        <div class="content">
            <div class="warning-box">
                ‚ö†Ô∏è <strong>Quan tr·ªçng:</strong> Hi·ªáu chu·∫©n n√™n th·ª±c hi·ªán m·ªói 2-4 tu·∫ßn ho·∫∑c khi thay dung d·ªãch m·ªõi. Lu√¥n r·ª≠a s·∫°ch probe tr∆∞·ªõc khi hi·ªáu chu·∫©n.
            </div>

            <div class="section">
                <h3>üß™ Hi·ªáu Chu·∫©n pH (2 ƒëi·ªÉm)</h3>
                <p>C·∫ßn dung d·ªãch chu·∫©n pH7 v√† pH4 (ho·∫∑c pH10)</p>
                
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="calibpH7()">üìè Set pH7</button>
                    <button class="btn btn-primary" onclick="calibpH4()">üìè Set pH4 (ho·∫∑c pH10)</button>
                </div>
                
                <div class="status" id="phStatus">Ch∆∞a hi·ªáu chu·∫©n</div>
                
                <div class="info-box">
                    <strong>üí° H∆∞·ªõng d·∫´n:</strong><br>
                    1. Nh√∫ng probe pH v√†o dung d·ªãch chu·∫©n pH7, ƒë·ª£i 30-60 gi√¢y<br>
                    2. B·∫•m "Set pH7"<br>
                    3. R·ª≠a probe b·∫±ng n∆∞·ªõc c·∫•t, lau kh√¥ nh·∫π<br>
                    4. Nh√∫ng v√†o dung d·ªãch chu·∫©n pH4 ho·∫∑c pH10, ƒë·ª£i 30-60 gi√¢y<br>
                    5. B·∫•m "Set pH4"<br>
                </div>
                
                <div class="warning-box">
                    <strong>‚öôÔ∏è Chi·∫øt √Åp Module pH (Aideepen / LM358):</strong><br>
                    <strong>H∆∞·ªõng v·∫∑n:</strong><br>
                    ‚Ä¢ <strong>CW (ph·∫£i)</strong> ‚Üí TƒÉng ƒëi·ªán √°p OUT ‚Üí pH hi·ªÉn th·ªã <strong>gi·∫£m</strong> (7.0 ‚Üí 6.5)<br>
                    ‚Ä¢ <strong>CCW (tr√°i)</strong> ‚Üí Gi·∫£m ƒëi·ªán √°p OUT ‚Üí pH hi·ªÉn th·ªã <strong>tƒÉng</strong> (7.0 ‚Üí 7.5)<br>
                    <br>
                    <strong>M·ª•c ti√™u:</strong> pH 6.86 ‚Üí OUT ‚âà 2.50V | pH 4.00 ‚Üí OUT ‚âà 3.00V<br>
                    <br>
                    <strong>‚ö†Ô∏è L∆∞u √Ω:</strong><br>
                    - KH√îNG ch·ªânh chi·∫øt √°p sau khi ƒë√£ hi·ªáu chu·∫©n ph·∫ßn m·ªÅm<br>
                    - V·∫∑n r·∫•t ch·∫≠m (1/8 v√≤ng m·ªói l·∫ßn)<br>
                    - N·∫øu c·∫ßn ch·ªânh: Reset hi·ªáu chu·∫©n ‚Üí Ch·ªânh chi·∫øt √°p ‚Üí Set l·∫°i pH7/pH4
                </div>
            </div>

            <div class="section">
                <h3>‚öñÔ∏è Hi·ªáu Chu·∫©n TDS</h3>
                <p>C·∫ßn dung d·ªãch chu·∫©n TDS (v√≠ d·ª•: 1413 ¬µS/cm ho·∫∑c 2764 ¬µS/cm)</p>
                
                <div class="form-group">
                    <label>EC Chu·∫©n (¬µS/cm) c·ªßa dung d·ªãch chu·∫©n:</label>
                    <input type="number" id="knownEC" value="1413" min="100" max="5000" placeholder="1413">
                    <small>V√≠ d·ª•: 1413 ¬µS/cm = 707 ppm, 2764 ¬µS/cm = 1382 ppm</small>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-secondary" onclick="calibTDS()">üìè Set TDS</button>
                </div>
                
                <div class="status" id="tdsStatus">Ch∆∞a hi·ªáu chu·∫©n</div>
                
                <div class="info-box">
                    <strong>üí° H∆∞·ªõng d·∫´n:</strong><br>
                    1. Nh√∫ng probe TDS v√†o dung d·ªãch chu·∫©n, ƒë·ª£i 30 gi√¢y<br>
                    2. Nh·∫≠p EC chu·∫©n (¬µS/cm) c·ªßa dung d·ªãch<br>
                    3. B·∫•m "Set TDS"<br>
                </div>
            </div>

            <div class="section">
                <h3>‚ö° Hi·ªáu Chu·∫©n ZMCT103C (D√≤ng ƒêi·ªán AC)</h3>
                <p>Hi·ªáu chu·∫©n c·∫£m bi·∫øn d√≤ng ƒëi·ªán AC 2 b∆∞·ªõc</p>
                
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="calibZMCTOffset()">üìè B∆∞·ªõc 1: Set Offset (Kh√¥ng t·∫£i)</button>
                </div>
                
                <div class="form-group">
                    <label>D√≤ng ƒëi·ªán th·ª±c t·∫ø (A) - ƒëo b·∫±ng ƒë·ªìng h·ªì v·∫°n nƒÉng:</label>
                    <input type="number" id="knownCurrent" value="1.0" min="0.1" max="50" step="0.1" placeholder="1.0">
                    <small>V√≠ d·ª•: 1.5A (ƒëo b·∫±ng ampe k√¨m ho·∫∑c ƒë·ªìng h·ªì v·∫°n nƒÉng)</small>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-secondary" onclick="calibZMCTSensitivity()">üìè B∆∞·ªõc 2: Set Sensitivity (C√≥ t·∫£i)</button>
                </div>
                
                <div class="status" id="zmctStatus">Ch∆∞a hi·ªáu chu·∫©n</div>
                
                <div class="info-box">
                    <strong>üí° H∆∞·ªõng d·∫´n:</strong><br>
                    <strong>B∆∞·ªõc 1:</strong> T·∫Øt t·∫•t c·∫£ thi·∫øt b·ªã ƒëi·ªán (kh√¥ng t·∫£i), b·∫•m "Set Offset"<br>
                    <strong>B∆∞·ªõc 2:</strong> B·∫≠t thi·∫øt b·ªã ƒëi·ªán ƒë√£ bi·∫øt d√≤ng, ƒëo b·∫±ng ampe k√¨m, nh·∫≠p gi√° tr·ªã, b·∫•m "Set Sensitivity"<br>
                    <strong>L∆∞u √Ω:</strong> C·∫ßn c√≥ t·∫£i ·ªïn ƒë·ªãnh (b√≥ng ƒë√®n, b∆°m n∆∞·ªõc) ƒë·ªÉ hi·ªáu chu·∫©n ch√≠nh x√°c.
                </div>
                
                <div class="warning-box">
                    <strong>‚öôÔ∏è Chi·∫øt √Åp Module ZMCT103C:</strong><br>
                    <strong>H∆∞·ªõng v·∫∑n:</strong><br>
                    ‚Ä¢ <strong>CW (ph·∫£i)</strong> ‚Üí TƒÉng bi√™n ƒë·ªô ‚Üí ƒê·ªô nh·∫°y <strong>cao h∆°n</strong><br>
                    ‚Ä¢ <strong>CCW (tr√°i)</strong> ‚Üí Gi·∫£m bi√™n ƒë·ªô ‚Üí ƒê·ªô nh·∫°y <strong>th·∫•p h∆°n</strong><br>
                    <br>
                    <strong>M·ª•c ti√™u:</strong><br>
                    ‚Ä¢ Kh√¥ng t·∫£i ‚Üí OUT ‚âà 2.5V<br>
                    ‚Ä¢ T·∫£i 100W (0.45A) ‚Üí OUT dao ƒë·ªông ¬±0.3-0.4V quanh 2.5V (2.1-2.9V)<br>
                    <br>
                    <strong>‚ö†Ô∏è L∆∞u √Ω:</strong><br>
                    - KH√îNG ch·ªânh chi·∫øt √°p sau khi ƒë√£ hi·ªáu chu·∫©n ph·∫ßn m·ªÅm<br>
                    - V·∫∑n r·∫•t ch·∫≠m (1/8 v√≤ng m·ªói l·∫ßn)<br>
                    - Tr√°nh b√£o h√≤a t√≠n hi·ªáu (OUT: 0.5V - 3.0V)
                </div>
            </div>

            <div class="section">
                <h3>üìä Qu·∫£n L√Ω ƒêi·ªán NƒÉng</h3>
                <button class="btn btn-warning" onclick="resetEnergy()">üîÑ Reset T·ªïng ƒêi·ªán NƒÉng (kWh)</button>
                <div class="status" id="energyStatus">T·ªïng ƒëi·ªán nƒÉng s·∫Ω reset v·ªÅ 0 kWh</div>
            </div>

            <div class="section">
                <h3>üîÑ Reset Hi·ªáu Chu·∫©n</h3>
                <button class="btn btn-danger" onclick="resetCalib()">‚ôªÔ∏è Reset T·∫•t C·∫£ Hi·ªáu Chu·∫©n</button>
                <div class="warning-box" style="margin-top: 15px;">
                    C·∫£nh b√°o: Reset s·∫Ω x√≥a t·∫•t c·∫£ c√°c gi√° tr·ªã hi·ªáu chu·∫©n ƒë√£ l∆∞u. H·ªá th·ªëng s·∫Ω d√πng gi√° tr·ªã m·∫∑c ƒë·ªãnh.
                </div>
            </div>
        </div>
    </div>
    <script>
        function calibpH7() {
            fetch('/calibration?setpH7=1', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'ok') {
                        document.getElementById('phStatus').innerHTML = '‚úÖ pH7 ƒë√£ ƒë∆∞·ª£c hi·ªáu chu·∫©n';
                    } else {
                        alert('‚ùå L·ªói khi hi·ªáu chu·∫©n pH7');
                    }
                });
        }
        
        function calibpH4() {
            fetch('/calibration?setpH4=1', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'ok') {
                        document.getElementById('phStatus').innerHTML = '‚úÖ pH4/10 ƒë√£ ƒë∆∞·ª£c hi·ªáu chu·∫©n';
                    } else {
                        alert('‚ùå L·ªói khi hi·ªáu chu·∫©n pH4');
                    }
                });
        }
        
        function calibTDS() {
            const knownEC = document.getElementById('knownEC').value;
            if (!knownEC || knownEC < 100) {
                alert('‚ùå Vui l√≤ng nh·∫≠p EC chu·∫©n h·ª£p l·ªá (‚â•100 ¬µS/cm)');
                return;
            }
            fetch('/calibration?setTDS=1&knownEC=' + knownEC, { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'ok') {
                        document.getElementById('tdsStatus').innerHTML = '‚úÖ TDS ƒë√£ ƒë∆∞·ª£c hi·ªáu chu·∫©n v·ªõi EC ' + knownEC + ' ¬µS/cm';
                    } else {
                        alert('‚ùå L·ªói khi hi·ªáu chu·∫©n TDS');
                    }
                });
        }
        
        function calibZMCTOffset() {
            fetch('/calibration?setZMCTOffset=1', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'ok') {
                        document.getElementById('zmctStatus').innerHTML = '‚úÖ B∆∞·ªõc 1: Offset ƒë√£ ƒë∆∞·ª£c hi·ªáu chu·∫©n';
                    } else {
                        alert('‚ùå L·ªói khi hi·ªáu chu·∫©n ZMCT Offset');
                    }
                });
        }

        function calibZMCTSensitivity() {
            const knownCurrent = document.getElementById('knownCurrent').value;
            if (!knownCurrent || knownCurrent < 0.1) {
                alert('‚ùå Vui l√≤ng nh·∫≠p d√≤ng ƒëi·ªán th·ª±c t·∫ø h·ª£p l·ªá (‚â•0.1A)');
                return;
            }
            fetch('/calibration?setZMCTSensitivity=1&knownCurrent=' + knownCurrent, { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'ok') {
                        document.getElementById('zmctStatus').innerHTML = '‚úÖ B∆∞·ªõc 2: Sensitivity ƒë√£ ƒë∆∞·ª£c hi·ªáu chu·∫©n v·ªõi ' + knownCurrent + 'A';
                    } else {
                        alert('‚ùå L·ªói khi hi·ªáu chu·∫©n ZMCT Sensitivity');
                    }
                });
        }

        function resetEnergy() {
            if (confirm('‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën reset t·ªïng ƒëi·ªán nƒÉng v·ªÅ 0 kWh?')) {
                fetch('/calibration?resetEnergy=1', { method: 'POST' })
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'ok') {
                            document.getElementById('energyStatus').innerHTML = '‚úÖ T·ªïng ƒëi·ªán nƒÉng ƒë√£ ƒë∆∞·ª£c reset v·ªÅ 0 kWh';
                        } else {
                            alert('‚ùå L·ªói khi reset ƒëi·ªán nƒÉng');
                        }
                    });
            }
        }

        function resetCalib() {
            if (confirm('‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën reset t·∫•t c·∫£ hi·ªáu chu·∫©n? H·ªá th·ªëng s·∫Ω d√πng gi√° tr·ªã m·∫∑c ƒë·ªãnh.')) {
                // TODO: Implement reset via API
                alert('T√≠nh nƒÉng reset ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn');
            }
        }
    </script>
</body>
</html>




